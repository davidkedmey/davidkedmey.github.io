<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dawkins' Biomorphs</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <nav class="site-nav">
    <a href="./">Hub</a>
    <a href="game/">Play</a>
    <a href="3d/">3D</a>
    <a href="dawkins-paper/">Read</a>
  </nav>
  <header class="top-bar">
    <span class="top-bar-title">Dawkins' Biomorphs</span>
    <button id="btn-about" class="top-bar-icon" title="About &amp; Help">⚙</button>
  </header>

  <main>
    <div id="offspring-grid"></div>

    <div id="action-bar">
      <div class="action-buttons">
        <button id="btn-reroll" title="Same parent, new mutations (asexual reproduction)">&#8635; New Brood</button>
        <button id="btn-breed" title="Cross with saved specimens (sexual reproduction)">&#9891;&#9893; Breed</button>
        <button id="btn-undo" title="Return to previous generation (Ctrl+Z)">&larr; Back</button>
        <div class="random-group">
          <button id="btn-random" title="Start with a random organism">Seed</button>
          <select id="random-mode" title="Random type">
            <option value="interesting">Interesting</option>
            <option value="pure">Pure random</option>
          </select>
        </div>
        <button id="btn-send-expedition" title="Register this creature in Expedition">Send to Expedition</button>
      </div>
    </div>
    <nav class="mode-tabs">
      <button class="mode-tab" data-mode="0">Pixel Peppering</button>
      <button class="mode-tab active" data-mode="1">Basic</button>
      <button class="mode-tab" data-mode="2">+ Symmetry</button>
      <button class="mode-tab" data-mode="3">+ Segments</button>
      <button class="mode-tab" data-mode="4">+ Gradients</button>
      <button class="mode-tab" data-mode="5">Full Dawkins</button>
      <button class="mode-tab" data-mode="6">+ Buds (Mustard)</button>
      <button class="mode-tab" data-mode="7">+ Exploratory</button>
      <button class="mode-tab" data-mode="8">+ Buds (Hox)</button>
      <button class="mode-tab" data-mode="9">+ Weak Linkage</button>
      <button class="mode-tab" data-mode="10">+ Redundancy</button>
    </nav>
    <div id="bud-legend" class="setting-row" style="display:none"></div>
    <div id="settings-bar">
      <div id="symmetry-controls" class="setting-row" style="display:none">
        <label>Symmetry:
          <select id="symmetry-select">
            <option value="left-right">Left-right</option>
            <option value="up-down">Up-down</option>
            <option value="four-way">Four-way radial</option>
            <option value="asymmetric">Asymmetric</option>
          </select>
        </label>
      </div>
      <div id="mode5-controls" class="setting-row" style="display:none">
        <label><input type="checkbox" id="alternating-asym"> Alternating asymmetry</label>
        <label><input type="checkbox" id="radial-sym"> Radial symmetry</label>
      </div>
      <div id="color-controls" class="setting-row" style="display:none">
        <label>Color:
          <select id="color-mode">
            <option value="none">None</option>
            <option value="depth">By depth</option>
            <option value="angle">By direction</option>
          </select>
        </label>
      </div>
      <div class="setting-row">
        <label class="mutation-label">Mutation:
          <select id="mutation-intensity">
            <option value="1">Gentle</option>
            <option value="2">Moderate</option>
            <option value="3">Wild</option>
          </select>
        </label>
      </div>
    </div>
    <p id="mode-description"></p>

  </main>

  <div id="genome-panel" class="collapsible-panel">
    <button class="panel-toggle">Genome</button>
    <div class="panel-content" style="display:none">
      <div id="genome-table"></div>
    </div>
  </div>

  <div id="genealogy-panel" class="collapsible-panel">
    <button class="panel-toggle">Genealogy</button>
    <div class="panel-content" style="display:none">
      <canvas id="genealogy-canvas"></canvas>
    </div>
  </div>

  <div id="gallery-panel" class="collapsible-panel">
    <button class="panel-toggle open">Gallery</button>
    <div class="panel-content" style="display:block">
      <div class="gallery-collection-bar">
        <label>Collection:
          <select id="gallery-collection">
            <option value="peppering">Peppering Art</option>
            <option value="classic" selected>Classic Biomorphs</option>
            <option value="saves">My Saves</option>
          </select>
        </label>
      </div>
      <div id="gallery-content" style="display:grid"></div>
    </div>
  </div>

  <div id="comparison-modal" style="display:none">
    <div class="comparison-content">
      <div class="comparison-side">
        <h3>Parent</h3>
        <canvas id="compare-parent" width="300" height="300"></canvas>
        <div id="compare-parent-genes" class="comparison-genes"></div>
      </div>
      <div class="comparison-side">
        <h3>Offspring</h3>
        <canvas id="compare-child" width="300" height="300"></canvas>
        <div id="compare-child-genes" class="comparison-genes"></div>
      </div>
      <div class="comparison-actions">
        <button id="compare-select">Select This Offspring</button>
        <button id="compare-dismiss">Cancel</button>
      </div>
    </div>
  </div>

  <div id="mate-picker-modal" style="display:none">
    <div class="mate-picker-content">
      <h3>Choose Mates</h3>
      <p class="mate-picker-hint">Select 1&ndash;4 specimens from your gallery to breed with the current parent</p>
      <div id="mate-picker-grid"></div>
      <div class="mate-picker-actions">
        <button id="mate-picker-confirm" disabled>Breed</button>
        <button id="mate-picker-cancel">Cancel</button>
      </div>
    </div>
  </div>

  <div id="breed-modal" style="display:none">
    <div class="breed-content">
      <div class="breed-parents" id="breed-parents"></div>
      <div id="breed-gene-comparison" class="breed-gene-comparison"></div>
      <div id="breed-offspring" class="breed-offspring-grid"></div>
      <div id="breed-detail-strip" class="breed-detail-strip"></div>
      <div class="breed-actions">
        <button id="breed-dismiss">Cancel</button>
      </div>
    </div>
  </div>

  <div id="about-modal" style="display:none">
    <div class="about-content">
      <h2>Dawkins' Biomorphs</h2>
      <p class="about-subtitle">Progressive embryologies from <em>The Evolution of Evolvability</em> (1988)</p>
      <span class="about-version">v0.13</span>
      <h3>How to Play</h3>
      <ul>
        <li>Click an offspring or press <kbd>1</kbd>–<kbd>8</kbd> to select it as the next parent</li>
        <li>Each generation introduces small random mutations</li>
        <li>Save favourites to the Gallery</li>
        <li>Breed specimens together with ♀♂ Breed</li>
        <li>Press <kbd>Ctrl+Z</kbd> to undo</li>
      </ul>
      <p class="about-credit">Based on Richard Dawkins' <em>The Evolution of Evolvability</em> (1988)</p>
      <button id="about-close">Close</button>
    </div>
  </div>

  <script src="peppering.js"></script>
  <script src="history.js"></script>
  <script src="biomorph.js"></script>
</body>
</html>
